
$path-height: $section-two-column-outer;
$file-height: 38px;

$file-path-padding: 24px;

$files-anim: 0.3s;

$project-overview-width: 160px;

$overview-height: 48px;
    

@mixin hoverable() {
  @include clickable();

  transition: background-color 0.1s ease;
  
  &:hover {
    background-color: hsl($hue, $saturation, 97%);
  }
  
}

@mixin header() {

  #header {
    
    > .comment {

      header {

        width: 100%;

        .file-path {
          @include font-mono();

          #project-overview {
            font-weight: bold;

            .version {
              float: right;
              font-weight: normal;
              font-size: 16px;
              color: hsl($hue, $saturation, 50%);
            }
            
          }
          
        }

        #filename {
          font-weight: bold;
          color: hsl($hue, $saturation, 30%);
          border-right: 1px solid $code-border-color;
        }

        .files {

          display: block;

          .file a {
            min-height: $file-height;
            line-height: $file-height;

            overflow: hidden;

            display: block;
            
            padding-left: $file-path-padding;
            padding-right: $file-path-padding;

            color: hsl($hue, $saturation, 30%);
            
            @include hoverable();

            @include font-mono();

            position: relative;

            .language {
              float: right;
              display: inline-block;
              font-size: 0;
              
              $size: 10px;
              
              line-height: $size;
              height: $size;
              width: $size;
              border-radius: $size * 2;

              color: transparent;
              position: absolute;
              top: 50%;
              right: 14px;
              transform: translateY(-50%);
            }

          }

          .file + .file {
            
            &.separator {
              border-top: 1px solid hsl($hue, $saturation, 92%) !important;
            }
            
          }
          
        }

      }
      
    }
    
  }

}

@mixin header-two-column() {
  
  #header {

    > .code {
      min-height: $path-height * 1.5;
    }
    
    > .comment {

      position: relative;

      header {

        background: $comment-bg;

        .file-path {

          height: $path-height + $overview-height + 1px;
          line-height: $path-height;

          border-bottom: 1px solid $comment-border-color;

          display: flex;
          flex-direction: column;

          #project-overview,
          #filename {
            border-right: 1px solid $code-border-color;
            
            display: inline-block;

            padding-left: $file-path-padding;
            padding-right: $file-path-padding;
          }

          #project-overview {
            border-bottom: 1px solid $code-border-color;
            height: $overview-height;
            line-height: $overview-height;
          }
            
          .files-menu {
            flex: 1;

            #filename {
              height: $path-height !important;

              display: inline-block;
              
              white-space: nowrap;
              overflow: hidden;
              
              line-height: $path-height;
              width: 100%;
              border-left: 1px solid $comment-border-color;
            }

            .files {
              border-top: 1px solid $comment-border-color;
              
              max-height: 80vh;
              max-height: calc(100vh - #{$path-height} - 48px);
              
              position: absolute;
              top: $path-height;
              margin-left: 0;
              
              display: block;
              overflow-y: auto;
              
              list-style-type: none;
              
              transform-origin: 0 0;
              transition: opacity $files-anim ease, transform $files-anim ease;
              
            }

          }
          
        }

      }
      
    }

  }
    
}

@mixin header-single-column() {
  
  #header > .comment {

    width: 100%;

    #project-overview {
      min-height: $overview-height;
      line-height: $overview-height !important;
    }
    
    #project-overview,
    #filename {
      display: block;

      padding: 0 $file-path-padding;
      
      border-bottom: 1px solid $comment-border-color;

    }

    a#project-overview {
      @include hoverable();
    }
    
    #filename {
      font-size: 150%;
      
      min-height: $path-height;
      line-height: $path-height !important;
    }

    .files-menu {
      border-bottom: 1px solid $code-border-color;
    }

  }
  
}
  
@mixin header-index() {
  
  #header > .comment {
    
    #project-overview {
      border-bottom: 1px solid $comment-border-color;
      font-size: 24px;
      border-right: none !important;
    }

    .file-path {
      border: none !important;
      display: flex;
      flex-direction: column;

      height: auto !important;

      #filename {
        display: none !important;
      }

      .files {
        border-top: none !important;
        position: static !important;
        top: 0;
        max-height: none !important;
        overflow-y: none;
      }
      
    }

  }

}

@mixin header-code() {

  #header {

    > .comment {

      position: relative;
      
      header {

        .spacer {
          flex: 1;
        }

        .file-path {

          @include two-column() {
            position: fixed;

            @include comment-width();

          }
          
          background: $comment-bg;

          #project-overview {
            @include hoverable();
            padding-left: $file-path-padding !important;
          }
          
          .files-menu {

            position: relative;

            #filename {
              @include hoverable();

              padding-right: $path-height;

              &:after {
                content: '';
                display: block;

                background-image: url('dropdown.png');

                position: absolute;
                top: 0;
                right: 0;

                z-index: 1000;

                opacity: 0.5;
                
                width: $path-height;
                height: $path-height;

                transform: scaleY(-1);
                transition: transform $files-anim ease;
              }
              
            }
            
            .files {

              position: absolute;
              top: $path-height + 1px;
              left: 0;
              margin-left: -1px;
              width: 100%;
              
              background: $comment-bg;

              border: 1px solid $comment-border-color;
              border-width: 0 1px 1px 1px;
              border-bottom-left-radius: 3px;
              
            }

          }
          
        }

      }

    }
    
    &.files-hidden {
      
      #filename {
        
        &:after {
          transform: scaleY(1) !important;
        }
        
      }
      
      .files.hidable {

        pointer-events: none;
        
        opacity: 0;
        
        transform: scaleY(0.9);
        
      }
      
    }

  }
  
}


